<html>
	<head>
		<link rel = "stylesheet" href = "main.css" />
		<title>
			3x3 Game
		</title>
	</head>
	<body>
		<div id = "container">
			<div class = "grid-container">
				<div class = "grid-item" id = "item1" onclick = "clic(1)"></div>
				<div class = "grid-item" id = "item2" onclick = "clic(2)"></div>
				<div class = "grid-item" id = "item3" onclick = "clic(3)"></div>
				<div class = "grid-item" id = "item4" onclick = "clic(4)"></div>
				<div class = "grid-item" id = "item5" onclick = "clic(5)"></div>
				<div class = "grid-item" id = "item6" onclick = "clic(6)"></div>
				<div class = "grid-item" id = "item7" onclick = "clic(7)"></div>
				<div class = "grid-item" id = "item8" onclick = "clic(8)"></div>
				<div class = "grid-item" id = "item9" onclick = "clic(9)"></div>
			</div>
		</div>
		<div>
			<div class = "grid-item" id = "item0">Start</div>
			<div class = "grid-item" id = "item10">Reset</div>
			<div id = "time"></div>
		</div>
		<script>
			document.getElementById("item0").addEventListener("mouseenter", time);
			document.addEventListener("click", clicking);
			function clicking() {
				clicks += 1;
			}
			function time() {
				document.getElementById("item0").addEventListener("mouseleave", exit);
				document.getElementById("item0").classList.add("active");
				window.time1 = setTimeout(func, 0, "3");
				window.time2 = setTimeout(func, 1000, "2");
				window.time3 = setTimeout(func, 2000, "1");
				window.time4 = setTimeout(func, 3000, " Go");
				window.time5 = setTimeout(sgame, 3000);
				window.time6 = setTimeout(func, 4000, "");
				window.time7 = setTimeout(
					function() {
						var d = new Date(); 
						window.n = d.getTime();
					}, 3000
				);		
			}
			function exit() {
				clearTimeout(time1);
				clearTimeout(time2);
				clearTimeout(time3);
				clearTimeout(time4);
				clearTimeout(time5);
				clearTimeout(time6);
				clearTimeout(time7);
				document.getElementById("item0").classList.remove("active");
				document.getElementById("time").innerText = "";
			}
			function clic(b) {
				if(document.getElementById("item" + b).classList.contains("active")) {
					document.getElementById("item" + b).classList.remove("active");
					game();
				}
			}
			function game() {
				if(i == 10) {
					console.log(i);
					var d1 = new Date();
					var n1 = d1.getTime();
					document.getElementById("item10").classList.remove("active");
					document.getElementById("item10").removeEventListener("click", abort);
					alert("Time: " + ((n1 - n) / 1000) + "s\nMisclicks: " + (window.clicks - 9));
					document.getElementById("item0").addEventListener("mouseenter", time);
					return;
				}
				i += 1;
				var x = Math.floor(Math.random() * 8 + 1);
				var y = a + x;
				y %= 9;
				if(y == 0)
					y = 9;
				document.getElementById("item" + y).classList.add("active");
				a = y;
			}
			function abort() {
				for(var i = 1; i <= 10; i++)
					document.getElementById("item" + i).classList.remove("active");
				document.getElementById("item10").removeEventListener("click", abort);
				document.getElementById("item0").addEventListener("mouseenter", time);
			}
			function func(a) {
				document.getElementById("time").innerText = a;
			}
			function sgame() {
				window.clicks = 0;
				document.getElementById("item0").classList.remove("active");
				document.getElementById("item0").removeEventListener("mouseenter", time);
				document.getElementById("item10").classList.add("active");
				document.getElementById("item10").addEventListener("click", abort);
				var x = Math.floor(Math.random() * 9 + 1);
				document.getElementById("item" + x).classList.add("active");
				window.a = x;
				window.i = 1;
			}
		</script>
	</body>
</html>